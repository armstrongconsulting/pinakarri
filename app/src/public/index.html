<!doctype html>
<html>
  <head>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:500,300,700,400" rel="stylesheet" type="text/css">
    <link href="css/main.css" rel="stylesheet" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.17/angular.min.js"></script>
  </head>
  <body ng-app="pinakarriApp">
    
    <div class="jumbotron" ng-controller="UnitController">
       <div class="container"> 
        <div>
        <h1>Pinakarri RaRo Offsite Activities</h1>
        <p>{{ unit.name }} ({{ unit.identifier }})</p>
        </div>
        <div>
        In order to book an activity, click the "Book" button. It will then turn green. This indicates that you have booked a seat. If there is no button available, then there are no remaining seats.
        </div>
      </div>
  </div>

    <div class="main" ng-controller="SubscriptionController">
      <div class="container">  
          
          <div class="table-responsive"> 
          <table class="table table-hover">
          <thead>
          <tr><th>Id</th><th>Name</th><th>Ranger / Rovers</th><th>Leaders</th></tr>
          </thead>
        <tbody ng-repeat="activity in subscriptions"> 
        <tr> 
            <td>{{ activity.identifier }}</td> 
          <td><a href="{{activity.external_link}}" target="{{activity.identifier}}">{{ activity.name}}</a></td>
          <td>
            <div><p><b>{{ activity.participants.available}}</b> seat(s) available</p><p><b>{{ activity.participants.booked}}</b> seat(s) booked by you</p></div>
            <hr/>
            <span ng-repeat="i in [1, 2, 3] track by $index">
                <button ng-show="activity.participants.booked >= i" type="button" class="btn btn-success book-button"  title="This seat belongs to you! If you click here again, you unbook your seat. Others may then take it." data-toggle="tooltip" ng-click="unsubscribe(activity.identifier)">Unbook</button>
                <button ng-show="activity.participants.booked < i && activity.participants.available > 0" type="button" class="btn btn-primary book-button"  title="Click to book your seat" data-toggle="tooltip" ng-click="subscribe(activity.identifier)">Book</button>
            </span>
          </td> 
          <td><div>
            <div><p><b>{{ activity.leaders.available}}</b> seat(s) available</p><p><b>{{ activity.leaders.booked}}</b> seat(s) booked by you.</div>
            <hr/>
            <div>
                <button ng-show="activity.leaders.booked >= 1" type="button" class="btn btn-success book-button"  title="Click to un-book your seat" data-toggle="tooltip" ng-click="unsubscribeLeader(activity.identifier)">Unbook</button>
                <button ng-show="activity.leaders.booked < 1 && activity.leaders.available >= 1" type="button" class="btn btn-primary book-button"  title="Click to book your seat" data-toggle="tooltip" ng-click="subscribeLeader(activity.identifier)">Book</button>
            
            </div>
          </div></td> 
      </tr> 
      </tbody>
      </table>
      </div>
      </div>
    </div>


    <!-- Modules -->
    <script src="js/app.js"></script>
 
    <!-- Controllers -->
    <script src="js/controllers/SubscriptionController.js"></script>
    <script src="js/controllers/UnitController.js"></script>
    

    
  </body>
</html>